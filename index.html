<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>üé≠ Teatro Coach IA</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;color:#fff;padding:20px}.container{max-width:1000px;margin:0 auto}header{text-align:center;margin-bottom:40px}header h1{font-size:2.5em;margin-bottom:10px}header p{font-size:1.2em;opacity:.9}.status{display:inline-block;background:rgba(76,175,80,.9);padding:8px 20px;border-radius:20px;margin-top:10px}.screen{display:none;background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border-radius:20px;padding:40px}.screen.active{display:block}.screen h2{font-size:2em;margin-bottom:30px;text-align:center}button{padding:15px 40px;font-size:18px;border:none;border-radius:10px;cursor:pointer;font-weight:bold;transition:all .3s;margin:5px}button:hover{transform:translateY(-2px)}. btn-primary{background:#4CAF50;color:#fff}.btn-secondary{background:rgba(255,255,255,.2);color:#fff}select,input,textarea{width:100%;padding:15px;border-radius:10px;border:2px solid rgba(255,255,255,.3);background:rgba(255,255,255,.1);color:#fff;font-size:16px;margin-bottom:20px}select option{background:#764ba2}textarea{min-height:250px;font-family:monospace;resize:vertical}.voice-btn{width:150px;height:150px;border-radius:50%;background:linear-gradient(145deg,#f093fb,#f5576c);margin:40px auto;display:flex;align-items:center;justify-content:center;font-size:4em;cursor:pointer;transition:all .3s}.voice-btn:hover{transform:scale(1.05)}.voice-btn.recording{animation:pulse 1.5s infinite}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}.info-box{background:rgba(0,0,0,.3);border-radius:15px;padding:20px;margin-bottom:20px}.info-box div{margin:10px 0}.info-box strong{color:#FFD700}.dialogue{background:rgba(0,0,0,.4);border-left:4px solid #4CAF50;padding:20px;border-radius:10px;margin:20px 0;font-size:1.2em;min-height:100px}.controls{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:30px}</style></head><body><div class="container"><header><h1>üé≠ Teatro Coach IA</h1><p>Asistente inteligente para ensayos teatrales por voz</p><span class="status">‚úì IA Conectada</span></header><div class="screen active" id="upload-screen"><h2>1. Sube tu Gui√≥n</h2><textarea id="script-input" placeholder="Pega aqu√≠ el texto de tu obra de teatro.\n\nFormato esperado:\nACTO I\nESCENA 1\nPERSONAJE1: Di√°logo...\nPERSONAJE2: Di√°logo..."></textarea><button class="btn-primary" onclick="parseScript()">Analizar Gui√≥n ‚û°Ô∏è</button></div><div class="screen" id="config-screen"><h2>2. Configuraci√≥n del Ensayo</h2><div class="info-box" id="script-info"></div><label>Tu personaje:</label><select id="character-select"><option value="">Selecciona tu personaje...</option></select><label>¬øPor d√≥nde quieres empezar?</label><select id="scene-select"><option value="">Selecciona acto/escena...</option></select><label>Modo de ensayo:</label><select id="mode-select"><option value="B">Modo B: Pies m√≠nimos</option><option value="C">Modo C: Apuntador m√≠nimo</option><option value="D">Modo D: Off-book examen</option><option value="A">Modo A: Pase completo</option><option value="E">Modo E: Direcci√≥n</option><option value="F">Modo F: Audici√≥n</option></select><div class="controls"><button class="btn-secondary" onclick="goBack('upload')‚Üê Volver</button><button class="btn-primary" onclick="startRehearsal()">üé≠ Comenzar Ensayo</button></div></div><div class="screen" id="rehearsal-screen"><h2>Ensayo por Voz</h2><div class="info-box"><div><strong>Personaje:</strong> <span id="r-character"></span></div><div><strong>Escena:</strong> <span id="r-scene"></span></div><div><strong>Modo:</strong> <span id="r-mode"></span></div><div><strong>Progreso:</strong> <span id="r-progress">0/0</span></div></div><div class="dialogue" id="dialogue-box">Presiona el bot√≥n de micr√≥fono para iniciar el ensayo por voz.</div><div class="voice-btn" id="voice-btn" onclick="toggleVoice()">üé§</div><div class="controls"><button class="btn-secondary" onclick="prevLine()">‚¨ÖÔ∏è Anterior</button><button class="btn-secondary" onclick="nextLine()">Siguiente ‚û°Ô∏è</button><button class="btn-secondary" onclick="goBack('config')">üö™ Salir</button></div></div></div><script>let scriptData={raw:'',acts:[],characters:[],scenes:[]};let rehearsalState={character:'',sceneIndex:0,lineIndex:0,mode:'B',lines:[]};let recognition=null;let synthesis=window.speechSynthesis;let isRecording=false;function parseScript(){const text=document.getElementById('script-input').value.trim();if(!text){alert('Por favor, pega el gui√≥n primero.');return}scriptData.raw=text;const lines=text.split('\n');let currentAct='';let currentScene='';let scenes=[];let characters=new Set();lines.forEach(line=>{line=line.trim();if(!line)return;if(/^ACTO\s+[IVX\d]+/i.test(line)){currentAct=line;currentScene=''}else if(/^ESCENA\s+[\d]+/i.test(line)){currentScene=line;scenes.push({act:currentAct,scene:currentScene,lines:[]})}else if(line.includes(':')){const match=line.match(/^([^:]+):\s*(.*)$/);if(match){const char=match[1].trim();const dialogue=match[2].trim();characters.add(char);if(scenes.length>0){scenes[scenes.length-1].lines.push({character:char,text:dialogue})}}}});scriptData.scenes=scenes;scriptData.characters=Array.from(characters);if(scriptData.characters.length===0){alert('No se detectaron personajes. Aseg√∫rate de usar el formato:\nPERSONAJE: di√°logo');return}if(scriptData.scenes.length===0){scriptData.scenes=[{act:'Acto √önico',scene:'Escena Completa',lines:[]}];lines.forEach(line=>{const match=line.match(/^([^:]+):\s*(.*)$/);if(match){scriptData.scenes[0].lines.push({character:match[1].trim(),text:match[2].trim()})}})}showConfigScreen()}function showConfigScreen(){const charSelect=document.getElementById('character-select');charSelect.innerHTML='<option value="">Selecciona tu personaje...</option>';scriptData.characters.forEach(char=>{charSelect.innerHTML+=`<option value="${char}">${char}</option>`});const sceneSelect=document.getElementById('scene-select');sceneSelect.innerHTML='<option value="">Selecciona acto/escena...</option>';scriptData.scenes.forEach((scene,i)=>{sceneSelect.innerHTML+=`<option value="${i}">${scene.act} - ${scene.scene}</option>`});document.getElementById('script-info').innerHTML=`<div><strong>Personajes detectados:</strong> ${scriptData.characters.join(', ')}</div><div><strong>Escenas encontradas:</strong> ${scriptData.scenes.length}</div>`;showScreen('config')}function startRehearsal(){const char=document.getElementById('character-select').value;const sceneIdx=document.getElementById('scene-select').value;const mode=document.getElementById('mode-select').value;if(!char||sceneIdx===''){alert('Por favor, selecciona tu personaje y la escena.');return}rehearsalState.character=char;rehearsalState.sceneIndex=parseInt(sceneIdx);rehearsalState.mode=mode;rehearsalState.lineIndex=0;const scene=scriptData.scenes[rehearsalState.sceneIndex];rehearsalState.lines=scene.lines.filter(l=>l.character===char||mode==='A');if(rehearsalState.lines.length===0){alert('No hay l√≠neas para tu personaje en esta escena.');return}setupSpeechRecognition();showRehearsalScreen()}function setupSpeechRecognition(){if('webkitSpeechRecognition'in window){recognition=new webkitSpeechRecognition();recognition.lang='es-ES';recognition.continuous=false;recognition.interimResults=false;recognition.onresult=function(event){const transcript=event.results[0][0].transcript;handleUserSpeech(transcript)};recognition.onerror=function(){alert('Error de reconocimiento. Aseg√∫rate de permitir el micr√≥fono.')};recognition.onend=function(){isRecording=false;document.getElementById('voice-btn').classList.remove('recording')}}else{alert('Tu navegador no soporta reconocimiento de voz. Usa Chrome.')}}function showRehearsalScreen(){const scene=scriptData.scenes[rehearsalState.sceneIndex];document.getElementById('r-character').textContent=rehearsalState.character;document.getElementById('r-scene').textContent=`${scene.act} - ${scene.scene}`;document.getElementById('r-mode').textContent=getModeDescription(rehearsalState.mode);updateProgress();showCurrentLine();showScreen('rehearsal')}function getModeDescription(mode){const modes={A:'Pase completo',B:'Pies m√≠nimos',C:'Apuntador m√≠nimo',D:'Off-book examen',E:'Direcci√≥n',F:'Audici√≥n'};return modes[mode]||''}function showCurrentLine(){const scene=scriptData.scenes[rehearsalState.sceneIndex];const allLines=scene.lines;const myLines=rehearsalState.lines;if(rehearsalState.lineIndex>=myLines.length){document.getElementById('dialogue-box').innerHTML='<strong>üéâ ¬°Has terminado esta escena!</strong>';speak('Has terminado esta escena. ¬°Bien hecho!');return}const currentLine=myLines[rehearsalState.lineIndex];const lineIndexInScene=allLines.findIndex(l=>l===currentLine);let previousLine=lineIndexInScene>0?allLines[lineIndexInScene-1]:null;let cue='';if(rehearsalState.mode==='B'&&previousLine){const words=previousLine.text.split(' ');cue=words.slice(0,Math.min(4,words.length)).join(' ')+'...'}else if(rehearsalState.mode==='C'&&previousLine){const words=previousLine.text.split(' ');cue=words.slice(0,2).join(' ')+'...'}let html='';if(cue){html+=`<div style="opacity:0.7;margin-bottom:15px"><strong>Pie:</strong> ${cue}</div>`}html+=`<div><strong>${currentLine.character}:</strong> (Tu l√≠nea)</div>`;document.getElementById('dialogue-box').innerHTML=html;if(cue){speak(`Tu pie es: ${cue}. Tu turno.`)}else{speak('Tu turno.')}}function speak(text){if(synthesis.speaking){synthesis.cancel()}const utterance=new SpeechSynthesisUtterance(text);utterance.lang='es-ES';utterance.rate=0.9;synthesis.speak(utterance)}function toggleVoice(){if(!recognition){alert('Reconocimiento de voz no disponible.');return}if(isRecording){recognition.stop();isRecording=false;document.getElementById('voice-btn').classList.remove('recording')}else{try{recognition.start();isRecording=true;document.getElementById('voice-btn').classList.add('recording');speak('Escuchando...')}catch(e){console.error(e)}}}function handleUserSpeech(transcript){const currentLine=rehearsalState.lines[rehearsalState.lineIndex];document.getElementById('dialogue-box').innerHTML+=`<div style="margin-top:15px;padding:10px;background:rgba(76,175,80,0.2);border-radius:5px"><strong>T√∫ dijiste:</strong> "${transcript}"</div>`;speak('Bien. Siguiente l√≠nea.');setTimeout(()=>{nextLine()},2000)}function nextLine(){rehearsalState.lineIndex++;updateProgress();showCurrentLine()}function prevLine(){if(rehearsalState.lineIndex>0){rehearsalState.lineIndex--;updateProgress();showCurrentLine()}}function updateProgress(){document.getElementById('r-progress').textContent=`${rehearsalState.lineIndex+1}/${rehearsalState.lines.length}`}function showScreen(name){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById(`${name}-screen`).classList.add('active')}function goBack(screen){showScreen(screen)}</script></body></html>
